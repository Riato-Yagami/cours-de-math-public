% ENVIRONMENT
\newenvironment{mysection}[1][gray!20]{%
    \ifthenelse{\boolean{boxedProperties}}{
        \begin{tcolorbox}[colback=white,
            colframe=#1!50,
            boxrule=5pt,
            outer arc=0pt,
            arc=0pt,
            grow to left by= -5pt
    ]
    }{
        \begin{tcolorbox}[colback=white,
            colframe=#1!50,
            boxrule=-1pt,
            arc=0pt,
            leftrule=3pt,
            left = 8pt,
            % boxsep= -3pt,
            % show bounding box
            grow to left by= -5pt
            % fill downwards
        ]
    }
}{%
    \end{tcolorbox}
}

\newenvironment{mysubsection}[1][gray!20]{%
    \begin{tcolorbox}[colback=white,
        colframe=#1!50,
        boxrule=-1pt,
        outer arc=0pt,
        arc=0pt,
        grow to left by= -5pt
    ]
}{%
    \end{tcolorbox}
}

% Switch implementation
\newboolean{default}
\newcommand{\case}{}
\newcommand{\default}{}

\newenvironment{switch}[1]{%
    \setboolean{default}{true}
    \renewcommand{\case}[2]{\ifthenelse{\equal{#1}{##1}}{%
        \setboolean{default}{false}##2}{}}%
    \renewcommand{\default}[1]{\ifthenelse{\boolean{default}}{##1}{}}
}{}

% SECTIONS
\input{header/command/sections.tex}

% ANSWERS
\newlength{\parline}
\newlength{\paroutindent}
\newlength{\lineheight}
\setlength{\lineheight}{\heightof{abcdefghijklmnoprstuvwxyz}}

\newcommand{\countlines}[1]{%
    \setlength{\paroutindent}{\expandafter\parindent}
    \setlength{\parline}{\heightof{\noindent\begin{minipage}{\linewidth}%
                \setlength{\parindent}{\paroutindent}#1\end{minipage}}}%
    \pgfmathparse{round(\parline / (0.9*\lineheight))}
    \newcount\linecount
    \pgfmathsetcount{\linecount}{\pgfmathresult}
}

\newcommand{\looptext}[2]{%
    \noindent
    \newcount\printcount
    \printcount=#2
    \loop
        #1
        \advance\printcount by -1
        \ifnum\printcount>0
    \repeat
}

\newcommand{\awsr}[1]{%
    \ifthenelse{\boolean{anwser}}{
        \result{#1}
    }{
        \countlines{#1}
        \pgfmathsetcount{\linecount}{\linecount + 1}
        \noindent\hspace{-9pt}
        \looptext{
            \noindent\dotfill
    
        }{\the\linecount}
    }
}

\newcommand{\result}[1]{
    \color{OrangeRed}#1\color{black}
}

% MATH

\newcommand{\modxy}[2]{\sqrt{#1^2+#2^2}}
\newcommand{\acroissement}[2]{\frac{#1(#2+h)-#1(#2)}{h}}

\newcommand{\pow}[2]{
    #1
    \foreach \n in {2,...,#2}{
        \times #1
    }
}
\newcommand{\lPowBrace}[2]{
    \underbrace{\pow{#1}{2} \times ... \times \pow{#1}{2}}_{#2 \textrm{ fois}}
}
\newcommand{\powBrace}[2]{
    \underbrace{#1 \times ... \times #1}_{#2 \textrm{ fois}}
}

\newcommand{\lfbrace}[1]{
    \left\{
        \begin{array}{ll}
            #1
        \end{array}
    \right.
}

\newcommand{\dl}[1]{
    o(x^{#1})
}

\newcommand{\pgcd}[2]{
    % \PGCD(#1,#2)
    #1 \wedge #2
}

\newcommand{\ppcm}[2]{
    % \PPCM(#1,#2)
    #1 \vee #2
}

\def\colWidth{1.5cm}
\newcommand{\propTable}[4]{
    \begin{tabular}{|C{\colWidth}|C{\colWidth}|}
        \hline
        $#1$ & $#2$ \\ \hline
        $#3$ & $#4$ \\ \hline
    \end{tabular}
}

% COMMANDS

\newcommand{\fsize}[1]{\fontsize{#1}{#1}\selectfont}

\NewDocumentCommand{\ifNotNull}{mmo}{
    \IfValueT{#1}{
        \ifx\relax#1\relax
            \IfValueT{#3}{
                #3
            }
        \else
            #2
        \fi
    }
}

\NewDocumentCommand{\limg}{m O{\linewidth}}{%
    \includegraphics[width=#2]{#1}%
}

\NewDocumentCommand{\img}{m O{\linewidth} O{0cm} o}{%
    \begin{figure}[H]%
        \centering%
        \hspace*{#3}
        \includegraphics[width=#2]{#1}%
        \IfValueTF{#4}{
            \caption{\underline{#4}}
            % \vspace{-0.4cm}
            }{
            % \vspace{-0.4cm}
        }
        \vspace{-0.45cm}
    \end{figure}%
}

\NewDocumentCommand{\ilink}{m g}{%
    \item
    \IfValueTF{#2}{\link{#1}{#2}}{\link{#1}}
}

\NewDocumentCommand{\link}{m g}{%
    \csn{#1}%
    \IfValueT{#2}{(#2)}%
}

\NewDocumentCommand{\TODO}{g}{%
    \color{Red} $\rightarrow$ \textbf{TODO}
    \IfValueT{#1}{(#1)}%
}

\newcommand{\leconInfoBox}[2]{
    \textbf{#1 :}\vspace{-0.25cm}
        \begin{multicols}{2}
            \begin{itemize}[label=$\blacktriangleright$, font = \small \color{Red}]
                #2
            \end{itemize}
        \end{multicols}
        \vspace{-0.4cm}
}

% TCOLORBOX

\newtcolorbox{infoBox}{
    colback=red!5!white,
    colframe=red!75!black,
    breakable
}

\newtcolorbox{prepBox}{
    colback=Blue!2!white,
    colframe=Blue!75!black,
    % width = 1.1\linewidth,
    grow sidewards by = 1cm,
    breakable
}

\newtcolorbox{twoColBox}{
    sidebyside, sidebyside align=top,
    enhanced,
    opacityback=0,
    colframe=red!75!black,
    frame hidden,
}

\NewDocumentCommand{\leconInfo}{mooo}{
    \begin{infoBox}
        \leconInfoBox{Niveaux}{#1}
        \ifNotNull{#2}{
            \tcbline
            \leconInfoBox{Prérequis}{#2}
        }
        \ifNotNull{#3}{
            \tcbline
            \leconInfoBox{Thèmes}{#3}
        }
        \ifNotNull{#4}{
            \tcbline
            \textbf{Motivation :} 
            #4
        }
    \end{infoBox}
}

\NewDocumentCommand{\seanceInfo}{ooooooo}{
    \begin{infoBox}
        \vspace{-0.05cm}
        \begin{tcbitemize}[raster rows=1,raster columns=20,raster height=1.65cm,
            raster every box/.style={colframe=red!50!black,colback=red!10!white}]
            \tcbitem[raster multicolumn=6] \textbf{Date :} #1
            \tcbitem[raster multicolumn=10] \textbf{Séquence :} #2
            \tcbitem[raster multicolumn=4] \textbf{Séance :} #3
        \end{tcbitemize}
        \vspace{-0.25cm}
        \ifNotNull{#4}{\tcbline \textbf{Objectif :} #4}
        \ifNotNull{#5}{\tcbline \leconInfoBox{Classe(s)}{#5}}
        \ifNotNull{#6}{\tcbline \leconInfoBox{Prérequi(s)}{#6}}
        \ifNotNull{#7}{\tcbline \textbf{Séance précédente :} #7}
    \end{infoBox}
}

\def\pDscr{\tcbitem[raster multicolumn=6, breakable]}
\def\pMdlt{\tcbitem[raster multicolumn=11, breakable]}
\def\pTime{\tcbitem[raster multicolumn=3, breakable, halign=center]}

\newcommand{\prepRow}[3]{
    \tcbitem[raster multicolumn=20, breakable]
    \tcblower

    \pDscr #1
    \pMdlt #2
    \pTime #3
}

\newcommand{\prepTable}[1]{
    \begin{prepBox}
        \begin{tcbitemize}[raster rows=1,raster columns=20,raster height=1.1cm, halign=center,
            raster every box/.style={colframe=Blue!50!black,colback=Blue!10!white, breakable}]
            \pDscr \textbf{Descriptif}
            \pMdlt \textbf{Modalité}
            \pTime \textbf{Durée}
        \end{tcbitemize}
        \begin{tcbitemize}[breakable, 
            % raster height=1000cm,
            raster equal height = rows, 
            raster columns=20, frame hidden,
            raster every box/.style={
                enhanced,
                % colframe=Blue!50!black,
                % frame hidden, 
                opacityback=0, valign=top, 
                size = tight
            }]
            #1
        \end{tcbitemize}
    \end{prepBox}
}

% TIKZ
\newcommand{\drawGrid}[3]{
    \foreach \n in {0,...,#1}
        \draw[line width = #3] (\n,0) -- (\n,#2);
    \foreach \n in {0,...,#2}
        \draw[line width = #3] (0,\n) -- (#1,\n);
}

\newcommand{\drawPoint}[4]{
    \node[shift={#4}, color = \pointColor] at (#2 - 0.5,#3 - 0.5) {#1};
    \draw[line width = \crossWidth, shift={#4}, color = \pointColor] (#2 - 0.25,#3) -- (#2 + 0.25,#3);
    \draw[line width = \crossWidth, shift={#4}, color = \pointColor] (#2,#3 - 0.25) -- (#2,#3 + 0.25);
}

% Tabular
\newcolumntype{C}[1]{>{\centering\arraybackslash}p{#1}}

% GEOMETRY

% \newcommand{\restoregeometry}{def}